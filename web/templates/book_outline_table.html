<!-- web/templates/book_outline_table.html -->
<table class="table table-striped table-bordered align-middle">
  <thead class="table-light">
    <tr>
      <th width="80">Глава</th>
      <th width="200">Название</th>
      <th width="100">Генерировать</th>
      {% for sl in storylines %}
      <th>{{ sl }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for ch in chapters %}
    <tr>
      <td><strong>{{ ch.Chapter }}</strong></td>
      <td>
        {% if ch.Content %}
          <a href="/chapter/{{ book.id }}/{{ ch.Chapter }}" class="text-decoration-none">
            {{ ch.Title }}
          </a>
        {% else %}
          <span class="text-muted">{{ ch.Title }}</span>
        {% endif %}
      </td>
      <td>
        {% if ch.Generate %}
          <input type="checkbox" 
                 hx-post="/toggle-chapter" 
                 hx-vals='{"book_id": {{ book.id }}, "chapter_num": {{ ch.Chapter }}, "enabled": false}' 
                 hx-swap="outerHTML" 
                 checked>
        {% else %}
          <input type="checkbox" 
                 hx-post="/toggle-chapter" 
                 hx-vals='{"book_id": {{ book.id }}, "chapter_num": {{ ch.Chapter }}, "enabled": true}' 
                 hx-swap="outerHTML">
        {% endif %}
      </td>
          {% for sl in storylines %}
          <td class="clickable-cell"
          data-book-id="{{ book.id }}"
          data-chapter="{{ ch.Chapter }}"
          data-line="{{ sl }}"
          data-content="{{ ch[sl] | e }}">
        {{ ch[sl] }}
      </td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>